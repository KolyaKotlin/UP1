<Page x:Class="_122_Fedchenko.Pages.DiagrammPage"
      xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
      xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
      xmlns:local="clr-namespace:_122_Fedchenko.Pages"
      xmlns:charts="clr-namespace:System.Windows.Forms.DataVisualization.Charting;assembly=System.Windows.Forms.DataVisualization"
      Title="DiagrammPage">

    <Grid Margin="10">
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto" />
            <RowDefinition Height="*" />
        </Grid.RowDefinitions>
        
        <StackPanel Orientation="Horizontal"
                    Grid.Row="0"
                    VerticalAlignment="Top"
                    Margin="0,0,0,10"
                    HorizontalAlignment="Left">
            <TextBlock Text="Пользователь:"
                       VerticalAlignment="Center"
                       Margin="0,0,5,0" />
            <ComboBox x:Name="CmbUser"
                      Width="200"
                      Height="25"
                      DisplayMemberPath="FIO"
                      SelectionChanged="UpdateChart"
                      Margin="0,0,10,0" />

            <TextBlock Text="Тип диаграммы:"
                       VerticalAlignment="Center"
                       Margin="0,0,5,0" />
            <ComboBox x:Name="CmbDiagram"
                      Width="70"
                      Height="25"
                      SelectionChanged="UpdateChart"
                      Margin="0,0,10,0" />

            <Button Content="Экспорт в Excel"
                    Width="150"
             
                    Margin="0,0,5,0"
                    Click="ExportToExcel_Click" />
            <Button Content="Экспорт в Word"
                    Width="150"
                    Click="ExportToWord_Click" />
        </StackPanel>

        <WindowsFormsHost Grid.Row="1"
                          x:Name="WindowsFormsHostChart">
            <charts:Chart x:Name="ChartPayments">
                <charts:Chart.Legends>
                    <charts:Legend />
                </charts:Chart.Legends>
            </charts:Chart>
        </WindowsFormsHost>
    </Grid>
</Page>
